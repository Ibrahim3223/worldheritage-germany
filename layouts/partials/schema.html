{{- if .IsHome }}
<!-- Organization Schema for Homepage -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "WorldHeritage.guide",
  "alternateName": "World Heritage Guide",
  "url": "{{ .Site.BaseURL }}",
  "logo": {
    "@type": "ImageObject",
    "url": "{{ "/logo.png" | absURL }}",
    "width": 512,
    "height": 512
  },
  "description": "{{ .Site.Params.description }}",
  "sameAs": [
    {{ with .Site.Params.twitter }}"https://twitter.com/{{ . }}"{{ end }}
    {{ with .Site.Params.facebook }}{{ if $.Site.Params.twitter }},{{ end }}"https://facebook.com/{{ . }}"{{ end }}
    {{ with .Site.Params.instagram }}{{ if or $.Site.Params.twitter $.Site.Params.facebook }},{{ end }}"https://instagram.com/{{ . }}"{{ end }}
  ]
}
</script>

<!-- WebSite Schema with SearchAction -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ .Site.Title }}",
  "url": "{{ .Site.BaseURL }}",
  "description": "{{ .Site.Params.description }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "{{ .Site.BaseURL }}search/?q={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>

<!-- WebPage Schema for Homepage -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ .Title }}",
  "description": "{{ .Site.Params.description }}",
  "url": "{{ .Permalink }}",
  "inLanguage": "en-US",
  "isPartOf": {
    "@type": "WebSite",
    "url": "{{ .Site.BaseURL }}"
  },
  "about": {
    "@type": "Thing",
    "name": "UNESCO World Heritage Sites in Germany"
  },
  "primaryImageOfPage": {
    "@type": "ImageObject",
    "url": "{{ "/logo.png" | absURL }}"
  }
}
</script>

<!-- SiteNavigationElement for Main Menu -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "Main Navigation",
  "itemListElement": [
    {{ range $index, $item := .Site.Menus.main }}
    {{ if $index }},{{ end }}
    {
      "@type": "SiteNavigationElement",
      "position": {{ add $index 1 }},
      "name": "{{ .Name }}",
      "url": "{{ .URL | absURL }}"
    }
    {{ end }}
  ]
}
</script>
{{- end }}

{{- if and .IsPage (eq .Section "sites") }}
<!-- TouristAttraction Schema for Heritage Sites -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TouristAttraction",
  "name": "{{ .Params.site_name }}",
  "description": "{{ with .Description }}{{ . }}{{ else }}{{ .Summary | truncate 200 }}{{ end }}",
  "url": "{{ .Permalink }}",
  {{ if .Params.images }}
  "image": [
    {{ range $index, $image := .Params.images }}
    {{ if $index }},{{ end }}
    {
      "@type": "ImageObject",
      "url": "{{ $image | absURL }}",
      "contentUrl": "{{ $image | absURL }}",
      "caption": "{{ $.Params.site_name }} - Heritage site in {{ $.Params.region }}, Germany"
    }
    {{ end }}
  ],
  {{ end }}
  {{ if and .Params.latitude .Params.longitude }}
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": {{ .Params.latitude }},
    "longitude": {{ .Params.longitude }}
  },
  "hasMap": "https://www.google.com/maps/search/?api=1&query={{ .Params.latitude }},{{ .Params.longitude }}",
  {{ end }}
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "{{ .Params.region }}",
    "addressCountry": {
      "@type": "Country",
      "name": "Germany"
    }
  },
  {{ if in .Params.tags "unesco" }}
  "additionalType": "https://schema.org/LandmarksOrHistoricalBuildings",
  "award": "UNESCO World Heritage Site",
  {{ end }}
  {{ with .Params.heritage_type }}
  "touristType": "{{ . }}",
  {{ end }}
  {{ with .Params.opening_hours }}
  "openingHours": "{{ . }}",
  {{ end }}
  {{ with .Params.entry_fee }}
  "ticketPrice": "{{ . }}",
  {{ end }}
  {{ with .Params.website }}
  "sameAs": "{{ . }}",
  {{ end }}
  "isAccessibleForFree": {{ if .Params.entry_fee }}false{{ else }}true{{ end }},
  "publicAccess": true,
  "containedInPlace": {
    "@type": "Country",
    "name": "Germany"
  }
}
</script>

<!-- Article Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ .Params.site_name }}",
  "description": "{{ with .Description }}{{ . }}{{ else }}{{ .Summary | truncate 200 }}{{ end }}",
  "url": "{{ .Permalink }}",
  {{ if .Params.images }}
  "image": {
    "@type": "ImageObject",
    "url": "{{ index .Params.images 0 | absURL }}",
    "width": 1200,
    "height": 630
  },
  {{ end }}
  "datePublished": "{{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
  "author": {
    "@type": "Organization",
    "name": "{{ .Site.Params.author | default "WorldHeritage.guide" }}",
    "url": "{{ .Site.BaseURL }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "WorldHeritage.guide",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ "/logo.png" | absURL }}",
      "width": 512,
      "height": 512
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ .Permalink }}"
  },
  "articleSection": "{{ .Params.heritage_type | default "Heritage Sites" }}"{{ if .Params.tags }},
  "keywords": "{{ delimit .Params.tags ", " }}, Germany, Heritage, {{ .Params.region }}"{{ end }}{{ if .Params.categories }},
  "articleBody": {{ .Plain | jsonify }}{{ end }}
}
</script>

<!-- WebPage Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ .Params.site_name }}",
  "description": "{{ with .Description }}{{ . }}{{ else }}{{ .Summary | truncate 200 }}{{ end }}",
  "url": "{{ .Permalink }}",
  "inLanguage": "en-US",
  "isPartOf": {
    "@type": "WebSite",
    "url": "{{ .Site.BaseURL }}"
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ .Site.BaseURL }}"
      },
      {{ if .Params.region }}
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ .Params.region }}",
        "item": "{{ .Site.BaseURL }}regions/{{ .Params.region | urlize }}/"
      },
      {{ end }}
      {
        "@type": "ListItem",
        "position": {{ if .Params.region }}3{{ else }}2{{ end }},
        "name": "{{ .Params.site_name }}",
        "item": "{{ .Permalink }}"
      }
    ]
  },
  "about": {
    "@type": "Place",
    "name": "{{ .Params.site_name }}"
  }{{ if .Params.images }},
  "primaryImageOfPage": {
    "@type": "ImageObject",
    "url": "{{ index .Params.images 0 | absURL }}",
    "caption": "{{ .Params.site_name }} - {{ .Params.region }}, Germany"
  }{{ end }}
}
</script>

<!-- BreadcrumbList Schema (Separate for enhanced visibility) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ .Site.BaseURL }}"
    },
    {{ if .Params.region }}
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ .Params.region }}",
      "item": "{{ .Site.BaseURL }}regions/{{ .Params.region | urlize }}/"
    },
    {{ end }}
    {
      "@type": "ListItem",
      "position": {{ if .Params.region }}3{{ else }}2{{ end }},
      "name": "{{ .Params.site_name }}",
      "item": "{{ .Permalink }}"
    }
  ]
}
</script>
{{- end }}

{{- if .IsSection }}
<!-- CollectionPage Schema for List Pages -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ .Title }}",
  "description": "{{ with .Description }}{{ . }}{{ else }}Browse {{ .Title | lower }} in Germany{{ end }}",
  "url": "{{ .Permalink }}",
  "inLanguage": "en-US",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ .Site.Title }}",
    "url": "{{ .Site.BaseURL }}"
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ .Site.BaseURL }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ .Title }}",
        "item": "{{ .Permalink }}"
      }
    ]
  },
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": {{ len .Pages }},
    "itemListElement": [
      {{- $pages := first 20 .Pages }}
      {{- range $index, $page := $pages }}
      {{- if $index }},{{ end }}
      {
        "@type": "ListItem",
        "position": {{ add $index 1 }},
        "url": "{{ $page.Permalink }}",
        "name": "{{ $page.Title }}"
      }
      {{- end }}
    ]
  }
}
</script>
{{- end }}
