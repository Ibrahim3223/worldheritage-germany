<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Primary Meta Tags -->
<title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
<meta name="title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}">
<meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
<meta name="author" content="{{ .Site.Params.author }}">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="bingbot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<!-- Canonical URL -->
<link rel="canonical" href="{{ .Permalink }}">

<!-- Language Alternates (for future i18n support) -->
<link rel="alternate" hreflang="en" href="{{ .Permalink }}">
<link rel="alternate" hreflang="de" href="{{ .Permalink }}">
<link rel="alternate" hreflang="x-default" href="{{ .Permalink }}">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
<meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
{{ if .Params.images }}
  {{ range first 3 .Params.images }}
<meta property="og:image" content="{{ . | absURL }}">
  {{ end }}
{{ else }}
<meta property="og:image" content="{{ "/logo.png" | absURL }}">
{{ end }}
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:locale" content="en_US">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="{{ .Permalink }}">
<meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
<meta name="twitter:description" content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
{{ if .Params.images }}
<meta name="twitter:image" content="{{ index .Params.images 0 | absURL }}">
<meta name="twitter:image:alt" content="{{ .Params.site_name }} - Heritage site in {{ .Params.region }}, Germany">
{{ else }}
<meta name="twitter:image" content="{{ "/logo.png" | absURL }}">
{{ end }}

<!-- Article specific meta -->
{{ if .IsPage }}
{{ with .PublishDate }}<meta property="article:published_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}">{{ end }}
{{ with .Lastmod }}<meta property="article:modified_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}">{{ end }}
{{ with .Site.Params.author }}<meta property="article:author" content="{{ . }}">{{ end }}
{{ with .Params.heritage_type }}<meta property="article:section" content="{{ . }}">{{ end }}
{{ range .Params.tags }}<meta property="article:tag" content="{{ . }}">{{ end }}
{{ end }}

<!-- Geo Tags for heritage sites -->
{{ if and .Params.latitude .Params.longitude }}
<meta name="geo.position" content="{{ .Params.latitude }};{{ .Params.longitude }}">
<meta name="ICBM" content="{{ .Params.latitude }}, {{ .Params.longitude }}">
<meta name="geo.placename" content="{{ .Params.site_name }}, {{ .Params.region }}, Germany">
{{ end }}
{{ with .Params.region }}
<meta name="geo.region" content="DE">
{{ end }}

<!-- Theme Color -->
<meta name="theme-color" content="#2C5F2D">
<meta name="msapplication-TileColor" content="#2C5F2D">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/favicon/android-chrome-512x512.png">
<link rel="manifest" href="/favicon/site.webmanifest">

<!-- DNS Prefetch for external domains -->
<link rel="dns-prefetch" href="https://tile.openstreetmap.org">
<link rel="dns-prefetch" href="https://unpkg.com">

<!-- Preconnect to critical external domains -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net">

<!-- Preload critical assets -->
<link rel="preload" href="/logo.png" as="image">
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap"></noscript>

<!-- Preload hero image on homepage -->
{{ if .IsHome }}
<link rel="preload" href="/images/hero-neuschwanstein.webp" as="image">
{{ end }}

<!-- Critical CSS (inline) -->
{{- partial "critical-css.html" . -}}

<!-- Deferred Stylesheets -->
<link rel="preload" href="/css/styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="/css/styles.css"></noscript>

<!-- Alpine.js for interactive components (carousel) -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

<!-- Leaflet CSS for maps (conditional) -->
{{ if and .Params.latitude .Params.longitude }}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
{{ end }}

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}" href="{{ "index.xml" | absURL }}">

<!-- JSON-LD Schema -->
{{- partial "schema.html" . -}}

<!-- Performance Monitoring -->
<meta name="format-detection" content="telephone=no">
<meta http-equiv="x-dns-prefetch-control" content="on">
